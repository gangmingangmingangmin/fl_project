# upload_run.yml

---
  - hosts: iotsubmasterservers
    tasks:
      - name: Upload server file
        copy:
          src: ./server.py
          dest: /home/ec2-user
          mode: 0755
      - name: run server
        command: "python3 server.py 9"
        async: 3600
        poll: 0
  - hosts: iotmasterservers
    tasks:
      - name: sleep
        script: ./sleep.py
  - hosts: iotslaveservers*
    tasks:
      - name: run client
        #script: /home/ec2-user/client.py "{{ inventory_hostname }}" run local script on remote
        command: "python3 /home/ec2-user/client.py {{ inventory_hostname }}"
